<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电话号码处理工具 - 带GitHub历史记录</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                        accent: '#F59E0B',
                        danger: '#EF4444',
                        dark: '#1F2937',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .transition-custom {
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }
            .scrollbar-thin {
                scrollbar-width: thin;
            }
            .scrollbar-thin::-webkit-scrollbar {
                width: 4px;
            }
            .scrollbar-thin::-webkit-scrollbar-thumb {
                background-color: rgba(79, 70, 229, 0.5);
                border-radius: 2px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800 min-h-screen flex flex-col transition-custom">
    <!-- 顶部导航 -->
    <header class="bg-white shadow-md sticky top-0 z-50 transition-custom">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa fa-phone-square text-primary text-2xl"></i>
                <h1 class="text-xl md:text-2xl font-bold text-primary">电话号码处理工具</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-100 transition-custom focus:outline-none focus:ring-2 focus:ring-primary/30">
                    <i class="fa fa-moon-o text-gray-600"></i>
                </button>
                <a href="https://github.com" target="_blank" class="flex items-center space-x-1 text-gray-600 hover:text-primary transition-custom focus:outline-none focus:ring-2 focus:ring-primary/30 p-1 rounded">
                    <i class="fa fa-github"></i>
                    <span class="hidden md:inline">GitHub</span>
                </a>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="flex-grow container mx-auto px-4 py-8">
        <!-- 介绍部分 -->
        <div class="mb-8 text-center max-w-3xl mx-auto">
            <h2 class="text-[clamp(1.5rem,3vw,2rem)] font-bold mb-4 text-dark">带历史记录的电话号码处理工具</h2>
            <p class="text-gray-600 mb-6">处理号码后自动保存到GitHub仓库，方便查看历史记录和追踪变化</p>
        </div>

        <!-- GitHub设置区域 -->
        <div class="mb-8 bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-custom">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fa fa-github text-primary mr-2"></i>GitHub 历史记录设置
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label class="block text-gray-700 mb-2 font-medium" for="github-token">GitHub 个人访问令牌</label>
                    <div class="relative">
                        <input type="password" id="github-token" placeholder="ghp_..." class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 transition-custom">
                        <button id="show-token" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-custom">
                            <i class="fa fa-eye"></i>
                        </button>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">需要 repo 权限，<a href="https://github.com/settings/tokens/new?scopes=repo" target="_blank" class="text-primary hover:underline">创建令牌</a></p>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2 font-medium" for="github-repo">仓库路径</label>
                    <input type="text" id="github-repo" placeholder="用户名/仓库名 (例如: username/phone-numbers)" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 transition-custom">
                </div>
                <div class="md:col-span-2">
                    <label class="block text-gray-700 mb-2 font-medium" for="github-path">保存路径</label>
                    <input type="text" id="github-path" value="numbers/history" placeholder="numbers/history" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 transition-custom">
                    <p class="text-xs text-gray-500 mt-1">号码文件在仓库中的保存目录</p>
                </div>
            </div>
            <div class="mt-4">
                <button id="test-github-connection" class="bg-accent hover:bg-accent/90 text-white px-4 py-2 rounded-lg transition-custom focus:outline-none focus:ring-2 focus:ring-accent/50 disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="fa fa-check mr-1"></i>测试连接
                </button>
                <span id="github-connection-status" class="ml-3 text-sm"></span>
            </div>
        </div>

        <!-- 文件上传区域 -->
        <div class="mb-8">
            <div id="drop-area" class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-custom bg-white shadow-sm hover:shadow-md">
                <i class="fa fa-file-text-o text-5xl text-gray-400 mb-4"></i>
                <p class="mb-4">拖放文本文件到此处，或 <span class="text-primary font-medium">点击选择文件</span></p>
                <p class="text-sm text-gray-500">支持 .txt 格式文件</p>
                <input type="file" id="file-input" accept=".txt" class="hidden">
                <button id="browse-btn" class="mt-4 bg-primary hover:bg-primary/90 text-white px-6 py-2 rounded-lg transition-custom focus:outline-none focus:ring-2 focus:ring-primary/50">
                    <i class="fa fa-folder-open mr-2"></i>选择文件
                </button>
            </div>
            <div id="file-info" class="mt-4 hidden">
                <div class="flex items-center p-3 bg-gray-100 rounded-lg">
                    <i class="fa fa-file-text text-primary mr-3"></i>
                    <span id="file-name" class="flex-grow truncate"></span>
                    <button id="remove-file" class="text-gray-500 hover:text-danger transition-custom p-1 rounded-full hover:bg-red-50">
                        <i class="fa fa-times"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- 选项设置 -->
        <div class="mb-8 bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-custom">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fa fa-sliders text-primary mr-2"></i>处理选项
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- 国家选择 -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">国家/地区</label>
                    <select id="country-select" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 transition-custom">
                        <option value="us">美国</option>
                        <option value="cn">中国</option>
                        <option value="uk">英国</option>
                        <option value="ca">加拿大</option>
                        <option value="au">澳大利亚</option>
                        <option value="all">全部</option>
                    </select>
                </div>
                
                <!-- 验证选项 -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">验证设置</label>
                    <div class="flex items-center">
                        <input type="checkbox" id="validate-numbers" checked class="mr-2 h-4 w-4 text-primary focus:ring-primary/50">
                        <label for="validate-numbers">只保留有效号码</label>
                    </div>
                </div>
                
                <!-- 格式化选项 -->
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">格式设置</label>
                    <div class="flex flex-col space-y-2">
                        <div class="flex items-center">
                            <input type="checkbox" id="format-numbers" checked class="mr-2 h-4 w-4 text-primary focus:ring-primary/50">
                            <label for="format-numbers">格式化号码</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="keep-order" checked class="mr-2 h-4 w-4 text-primary focus:ring-primary/50">
                            <label for="keep-order">保持原始顺序</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 text-center">
                <button id="process-btn" class="bg-secondary hover:bg-secondary/90 text-white px-8 py-3 rounded-lg text-lg font-medium transition-custom disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-secondary/50" disabled>
                    <i class="fa fa-cogs mr-2"></i>处理并保存号码
                </button>
            </div>
        </div>

        <!-- 历史记录 -->
        <div class="mb-8 bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-custom">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fa fa-history text-primary mr-2"></i>历史记录
            </h3>
            <div id="history-container" class="max-h-60 overflow-y-auto scrollbar-thin">
                <p class="text-gray-500 italic text-center py-6" id="no-history-message">未加载到历史记录，请先配置GitHub信息</p>
                <div id="history-list" class="hidden space-y-3"></div>
            </div>
            <div class="mt-4 text-center">
                <button id="load-history" class="text-primary hover:text-primary/80 flex items-center mx-auto transition-custom disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-primary/30 p-1 rounded">
                    <i class="fa fa-refresh mr-1"></i> 加载历史记录
                </button>
            </div>
        </div>

        <!-- 处理结果 -->
        <div id="results-section" class="hidden mb-8 opacity-0 transition-custom duration-500">
            <div class="bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-custom">
                <!-- 结果标签页 -->
                <div class="border-b border-gray-200">
                    <ul class="flex flex-wrap -mb-px text-sm font-medium text-center" id="result-tabs" role="tablist">
                        <li class="mr-2" role="presentation">
                            <button class="inline-block p-4 border-b-2 border-primary text-primary rounded-t-lg transition-custom" id="valid-tab" data-tabs-target="#valid-numbers" type="button" role="tab" aria-selected="true">
                                <i class="fa fa-check-circle mr-1"></i>有效号码
                                <span id="valid-count" class="bg-primary/10 text-primary text-xs px-2 py-1 rounded-full ml-1"></span>
                            </button>
                        </li>
                        <li class="mr-2" role="presentation">
                            <button class="inline-block p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 rounded-t-lg transition-custom" id="invalid-tab" data-tabs-target="#invalid-numbers" type="button" role="tab" aria-selected="false">
                                <i class="fa fa-times-circle mr-1"></i>无效号码
                                <span id="invalid-count" class="bg-danger/10 text-danger text-xs px-2 py-1 rounded-full ml-1"></span>
                            </button>
                        </li>
                        <li role="presentation">
                            <button class="inline-block p-4 border-b-2 border-transparent hover:text-gray-600 hover:border-gray-300 rounded-t-lg transition-custom" id="stats-tab" data-tabs-target="#statistics" type="button" role="tab" aria-selected="false">
                                <i class="fa fa-bar-chart mr-1"></i>统计信息
                            </button>
                        </li>
                    </ul>
                </div>
                
                <!-- 结果内容 -->
                <div id="result-tabs-content">
                    <!-- 有效号码 -->
                    <div class="p-6" id="valid-numbers" role="tabpanel">
                        <div class="flex flex-wrap justify-between items-center mb-4 gap-2">
                            <h3 class="font-semibold text-lg">有效电话号码</h3>
                            <div class="flex space-x-2">
                                <button id="save-to-github" class="text-green-600 hover:text-green-700 flex items-center transition-custom focus:outline-none focus:ring-2 focus:ring-green-200 p-1 rounded">
                                    <i class="fa fa-github mr-1"></i> 保存到GitHub
                                </button>
                                <button id="export-valid" class="text-primary hover:text-primary/80 flex items-center transition-custom focus:outline-none focus:ring-2 focus:ring-primary/30 p-1 rounded">
                                    <i class="fa fa-download mr-1"></i> 导出
                                </button>
                            </div>
                        </div>
                        <div class="relative">
                            <div id="valid-numbers-container" class="max-h-96 overflow-y-auto p-4 bg-gray-50 rounded-lg text-sm scrollbar-thin">
                                <!-- 有效号码将在这里显示 -->
                            </div>
                            <div id="valid-loading" class="hidden absolute inset-0 flex items-center justify-center bg-white/80">
                                <i class="fa fa-spinner fa-spin text-primary text-2xl"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 无效号码 -->
                    <div class="p-6 hidden" id="invalid-numbers" role="tabpanel">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-semibold text-lg">无效电话号码</h3>
                            <button id="export-invalid" class="text-primary hover:text-primary/80 flex items-center transition-custom focus:outline-none focus:ring-2 focus:ring-primary/30 p-1 rounded">
                                <i class="fa fa-download mr-1"></i> 导出
                            </button>
                        </div>
                        <div id="invalid-numbers-container" class="max-h-96 overflow-y-auto p-4 bg-gray-50 rounded-lg text-sm scrollbar-thin">
                            <!-- 无效号码将在这里显示 -->
                        </div>
                    </div>
                    
                    <!-- 统计信息 -->
                    <div class="p-6 hidden" id="statistics" role="tabpanel">
                        <h3 class="font-semibold text-lg mb-4">处理统计</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-gray-50 p-4 rounded-lg hover:shadow-sm transition-custom">
                                <p class="text-gray-500 text-sm">总提取号码</p>
                                <p id="total-count" class="text-2xl font-bold text-dark">0</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg hover:shadow-sm transition-custom">
                                <p class="text-green-500 text-sm">有效号码</p>
                                <p id="stats-valid-count" class="text-2xl font-bold text-green-600">0</p>
                            </div>
                            <div class="bg-red-50 p-4 rounded-lg hover:shadow-sm transition-custom">
                                <p class="text-red-500 text-sm">无效号码</p>
                                <p id="stats-invalid-count" class="text-2xl font-bold text-red-600">0</p>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg mb-4 hover:shadow-sm transition-custom">
                            <h4 class="font-medium mb-2">有效号码占比</h4>
                            <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                                <div id="valid-percentage-bar" class="bg-secondary h-4 rounded-full transition-custom duration-1000 ease-out" style="width: 0%"></div>
                            </div>
                            <p id="valid-percentage-text" class="text-right text-sm mt-1 text-gray-600">0%</p>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg hover:shadow-sm transition-custom">
                            <h4 class="font-medium mb-3">国家/地区分布</h4>
                            <div id="country-distribution" class="space-y-2">
                                <!-- 国家分布将在这里显示 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 帮助信息 -->
        <div class="bg-white p-6 rounded-lg shadow-sm mb-8 hover:shadow-md transition-custom">
            <h3 class="text-lg font-semibold mb-4 flex items-center">
                <i class="fa fa-question-circle text-primary mr-2"></i>使用帮助
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm">
                <div>
                    <h4 class="font-medium text-gray-800 mb-2">GitHub 集成</h4>
                    <ul class="list-disc pl-5 space-y-1 text-gray-600">
                        <li>创建带有 repo 权限的 GitHub 个人访问令牌</li>
                        <li>指定要保存的仓库（格式：用户名/仓库名）</li>
                        <li>处理号码后会自动保存到指定仓库</li>
                        <li>历史记录会显示所有保存的号码文件</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-medium text-gray-800 mb-2">如何使用</h4>
                    <ul class="list-disc pl-5 space-y-1 text-gray-600">
                        <li>配置GitHub信息并测试连接</li>
                        <li>上传包含电话号码的TXT文件</li>
                        <li>选择适当的处理选项</li>
                        <li>点击"处理并保存号码"按钮</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-6">
        <div class="container mx-auto px-4 text-center">
            <p class="mb-2">电话号码处理工具 &copy; 2023</p>
            <p class="text-sm text-gray-400">带GitHub历史记录功能</p>
        </div>
    </footer>

    <!-- 通知提示 -->
    <div id="notification" class="fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-custom flex items-center z-50 max-w-xs"></div>

    <script>
        // 模块化组织代码
        document.addEventListener('DOMContentLoaded', () => {
            // 初始化应用
            PhoneNumberProcessor.init();
        });

        const PhoneNumberProcessor = {
            // 全局状态
            state: {
                processingResults: {
                    validNumbers: [],
                    invalidNumbers: [],
                    totalCount: 0,
                    fileName: ''
                },
                githubSettings: {
                    token: '',
                    repo: '',
                    path: 'numbers/history'
                },
                isDarkMode: false
            },

            // DOM 元素缓存
            elements: {},

            // 初始化应用
            init() {
                // 缓存DOM元素
                this.cacheElements();
                
                // 加载设置
                this.loadGithubSettings();
                
                // 检查GitHub设置
                this.checkGithubSettings();
                
                // 绑定事件处理程序
                this.bindEvents();
            },

            // 缓存DOM元素
            cacheElements() {
                // 通用元素
                this.elements.dropArea = document.getElementById('drop-area');
                this.elements.fileInput = document.getElementById('file-input');
                this.elements.browseBtn = document.getElementById('browse-btn');
                this.elements.fileInfo = document.getElementById('file-info');
                this.elements.fileName = document.getElementById('file-name');
                this.elements.removeFile = document.getElementById('remove-file');
                this.elements.processBtn = document.getElementById('process-btn');
                this.elements.resultsSection = document.getElementById('results-section');
                this.elements.themeToggle = document.getElementById('theme-toggle');
                this.elements.notification = document.getElementById('notification');
                
                // 结果显示元素
                this.elements.validNumbersContainer = document.getElementById('valid-numbers-container');
                this.elements.invalidNumbersContainer = document.getElementById('invalid-numbers-container');
                this.elements.validCount = document.getElementById('valid-count');
                this.elements.invalidCount = document.getElementById('invalid-count');
                this.elements.totalCountEl = document.getElementById('total-count');
                this.elements.statsValidCount = document.getElementById('stats-valid-count');
                this.elements.statsInvalidCount = document.getElementById('stats-invalid-count');
                this.elements.validPercentageBar = document.getElementById('valid-percentage-bar');
                this.elements.validPercentageText = document.getElementById('valid-percentage-text');
                this.elements.countryDistribution = document.getElementById('country-distribution');
                this.elements.exportValidBtn = document.getElementById('export-valid');
                this.elements.exportInvalidBtn = document.getElementById('export-invalid');
                this.elements.saveToGithubBtn = document.getElementById('save-to-github');
                this.elements.validLoading = document.getElementById('valid-loading');
                
                // 历史记录元素
                this.elements.historyContainer = document.getElementById('history-container');
                this.elements.historyList = document.getElementById('history-list');
                this.elements.noHistoryMessage = document.getElementById('no-history-message');
                this.elements.loadHistoryBtn = document.getElementById('load-history');
                
                // GitHub设置元素
                this.elements.githubTokenInput = document.getElementById('github-token');
                this.elements.githubRepoInput = document.getElementById('github-repo');
                this.elements.githubPathInput = document.getElementById('github-path');
                this.elements.showTokenBtn = document.getElementById('show-token');
                this.elements.testGithubConnectionBtn = document.getElementById('test-github-connection');
                this.elements.githubConnectionStatus = document.getElementById('github-connection-status');
                
                // 选项元素
                this.elements.countrySelect = document.getElementById('country-select');
                this.elements.validateNumbers = document.getElementById('validate-numbers');
                this.elements.formatNumbers = document.getElementById('format-numbers');
                this.elements.keepOrder = document.getElementById('keep-order');
                
                // 标签页元素
                this.elements.resultTabs = document.querySelectorAll('#result-tabs button');
            },

            // 绑定事件处理程序
            bindEvents() {
                // 显示/隐藏令牌
                this.elements.showTokenBtn.addEventListener('click', () => this.toggleTokenVisibility());
                
                // 测试GitHub连接
                this.elements.testGithubConnectionBtn.addEventListener('click', () => this.testGithubConnection());
                
                // 加载历史记录
                this.elements.loadHistoryBtn.addEventListener('click', () => this.loadHistory());
                
                // 文件上传处理
                this.elements.browseBtn.addEventListener('click', () => this.elements.fileInput.click());
                this.elements.fileInput.addEventListener('change', (e) => e.target.files.length > 0 && this.handleFile(e.target.files[0]));
                
                // 拖放功能
                this.elements.dropArea.addEventListener('dragover', (e) => this.handleDragOver(e));
                this.elements.dropArea.addEventListener('dragleave', () => this.handleDragLeave());
                this.elements.dropArea.addEventListener('drop', (e) => this.handleDrop(e));
                
                // 移除文件
                this.elements.removeFile.addEventListener('click', () => this.removeFile());
                
                // 处理号码
                this.elements.processBtn.addEventListener('click', () => this.processNumbers());
                
                // 标签页切换
                this.elements.resultTabs.forEach(tab => {
                    tab.addEventListener('click', () => this.showTab(tab.id));
                });
                
                // 保存到GitHub
                this.elements.saveToGithubBtn.addEventListener('click', () => this.saveToGithub());
                
                // 导出功能
                this.elements.exportValidBtn.addEventListener('click', () => 
                    this.exportNumbers(this.state.processingResults.validNumbers, '有效电话号码.txt'));
                this.elements.exportInvalidBtn.addEventListener('click', () => 
                    this.exportNumbers(this.state.processingResults.invalidNumbers, '无效电话号码.txt'));
                
                // 主题切换
                this.elements.themeToggle.addEventListener('click', () => this.toggleTheme());
                
                // 监听GitHub设置变化
                [this.elements.githubTokenInput, this.elements.githubRepoInput, this.elements.githubPathInput].forEach(input => {
                    input.addEventListener('input', () => {
                        this.checkGithubSettings();
                        this.saveGithubSettings();
                    });
                });
                
                // 事件委托 - 历史记录查看
                this.elements.historyList.addEventListener('click', (e) => {
                    const viewBtn = e.target.closest('.view-history-item');
                    if (viewBtn) {
                        const url = viewBtn.getAttribute('data-url');
                        this.viewHistoryItem(url);
                    }
                });
            },

            // 显示/隐藏令牌
            toggleTokenVisibility() {
                const type = this.elements.githubTokenInput.getAttribute('type') === 'password' ? 'text' : 'password';
                this.elements.githubTokenInput.setAttribute('type', type);
                this.elements.showTokenBtn.innerHTML = type === 'password' ? 
                    '<i class="fa fa-eye"></i>' : '<i class="fa fa-eye-slash"></i>';
            },

            // 保存GitHub设置到本地存储
            saveGithubSettings() {
                this.state.githubSettings = {
                    token: this.elements.githubTokenInput.value,
                    repo: this.elements.githubRepoInput.value,
                    path: this.elements.githubPathInput.value
                };
                localStorage.setItem('githubSettings', JSON.stringify(this.state.githubSettings));
            },

            // 从本地存储加载GitHub设置
            loadGithubSettings() {
                const settings = localStorage.getItem('githubSettings');
                if (settings) {
                    this.state.githubSettings = JSON.parse(settings);
                    this.elements.githubTokenInput.value = this.state.githubSettings.token || '';
                    this.elements.githubRepoInput.value = this.state.githubSettings.repo || '';
                    this.elements.githubPathInput.value = this.state.githubSettings.path || 'numbers/history';
                }
            },

            // 检查GitHub设置是否完整
            checkGithubSettings() {
                const hasToken = this.elements.githubTokenInput.value.trim() !== '';
                const hasRepo = this.elements.githubRepoInput.value.trim() !== '';
                
                this.elements.loadHistoryBtn.disabled = !(hasToken && hasRepo);
                this.elements.testGithubConnectionBtn.disabled = !(hasToken && hasRepo);
                
                return hasToken && hasRepo;
            },

            // 测试GitHub连接
            async testGithubConnection() {
                if (!this.checkGithubSettings()) return;
                
                this.elements.githubConnectionStatus.innerHTML = 
                    '<i class="fa fa-spinner fa-spin text-gray-500"></i> 测试连接中...';
                
                try {
                    const [owner, repo] = this.elements.githubRepoInput.value.split('/');
                    if (!owner || !repo) {
                        throw new Error('仓库路径格式不正确，应为：用户名/仓库名');
                    }
                    
                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}`, {
                        headers: {
                            'Authorization': `token ${this.elements.githubTokenInput.value}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (response.ok) {
                        this.elements.githubConnectionStatus.innerHTML = 
                            '<i class="fa fa-check text-green-500"></i> 连接成功';
                        this.showNotification('GitHub连接测试成功', 'success');
                        
                        // 保存设置
                        this.saveGithubSettings();
                        
                        // 尝试加载历史记录
                        this.loadHistory();
                    } else {
                        const error = await response.json();
                        throw new Error(error.message || '连接失败，检查令牌权限和仓库路径');
                    }
                } catch (error) {
                    this.elements.githubConnectionStatus.innerHTML = 
                        `<i class="fa fa-times text-red-500"></i> ${error.message}`;
                    this.showNotification(`GitHub连接测试失败: ${error.message}`, 'error');
                }
            },

            // 加载历史记录
            async loadHistory() {
                if (!this.checkGithubSettings()) return;
                
                this.elements.historyContainer.innerHTML = 
                    '<div class="text-center py-6"><i class="fa fa-spinner fa-spin text-primary text-2xl"></i><p class="mt-2 text-gray-500">加载历史记录中...</p></div>';
                
                try {
                    const [owner, repo] = this.elements.githubRepoInput.value.split('/');
                    const path = this.elements.githubPathInput.value.trim() || 'numbers/history';
                    
                    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
                        headers: {
                            'Authorization': `token ${this.elements.githubTokenInput.value}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            // 目录不存在，显示没有历史记录
                            this.elements.noHistoryMessage.classList.remove('hidden');
                            this.elements.historyList.classList.add('hidden');
                            return;
                        }
                        
                        const error = await response.json();
                        throw new Error(error.message || '加载历史记录失败');
                    }
                    
                    const files = await response.json();
                    
                    if (files.length === 0) {
                        this.elements.noHistoryMessage.classList.remove('hidden');
                        this.elements.historyList.classList.add('hidden');
                        return;
                    }
                    
                    // 按更新时间排序（最新的在前）
                    files.sort((a, b) => new Date(b.updated_at) - new Date(a.updated_at));
                    
                    // 生成历史记录HTML
                    let historyHtml = '';
                    files.forEach(file => {
                        if (file.type === 'file' && file.name.endsWith('.txt')) {
                            const date = new Date(file.updated_at).toLocaleString();
                            historyHtml += `
                                <div class="p-3 border border-gray-100 rounded-lg hover:bg-gray-50 transition-custom">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-medium truncate">${file.name}</p>
                                            <p class="text-xs text-gray-500">更新于 ${date}</p>
                                        </div>
                                        <button class="view-history-item text-primary hover:text-primary/80" data-url="${file.download_url}">
                                            <i class="fa fa-eye mr-1"></i> 查看
                                        </button>
                                    </div>
                                </div>
                            `;
                        }
                    });
                    
                    if (historyHtml === '') {
                        this.elements.noHistoryMessage.classList.remove('hidden');
                        this.elements.historyList.classList.add('hidden');
                    } else {
                        this.elements.noHistoryMessage.classList.add('hidden');
                        this.elements.historyList.innerHTML = historyHtml;
                        this.elements.historyList.classList.remove('hidden');
                    }
                } catch (error) {
                    this.elements.historyContainer.innerHTML = 
                        `<p class="text-red-500 text-center py-6">加载历史记录失败: ${error.message}</p>`;
                    this.showNotification(`加载历史记录失败: ${error.message}`, 'error');
                }
            },

            // 查看历史记录项
            async viewHistoryItem(url) {
                this.elements.validLoading.classList.remove('hidden');
                
                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error('无法加载历史记录');
                    
                    const content = await response.text();
                    const numbers = content.split('\n').filter(num => num.trim() !== '');
                    
                    // 显示历史记录内容
                    this.elements.validNumbersContainer.innerHTML = numbers
                        .map(num => `<div class="py-1 border-b border-gray-100 last:border-0">${num}</div>`)
                        .join('');
                    
                    // 更新计数
                    this.elements.validCount.textContent = numbers.length;
                    this.elements.invalidCount.textContent = 0;
                    this.elements.totalCountEl.textContent = numbers.length;
                    this.elements.statsValidCount.textContent = numbers.length;
                    this.elements.statsInvalidCount.textContent = 0;
                    
                    // 更新统计
                    this.elements.validPercentageBar.style.width = '100%';
                    this.elements.validPercentageText.textContent = '100%';
                    this.elements.countryDistribution.innerHTML = 
                        '<p class="text-gray-500 italic">历史记录不包含统计信息</p>';
                    
                    // 显示结果区域
                    this.elements.resultsSection.classList.remove('hidden');
                    // 触发动画
                    setTimeout(() => {
                        this.elements.resultsSection.style.opacity = '1';
                    }, 10);
                    
                    this.showTab('valid-tab');
                    
                    // 更新处理结果
                    this.state.processingResults = {
                        validNumbers: numbers,
                        invalidNumbers: [],
                        totalCount: numbers.length,
                        fileName: url.split('/').pop()
                    };
                } catch (error) {
                    this.showNotification(`查看历史记录失败: ${error.message}`, 'error');
                } finally {
                    this.elements.validLoading.classList.add('hidden');
                }
            },

            // 拖放处理
            handleDragOver(e) {
                e.preventDefault();
                this.elements.dropArea.classList.add('border-primary', 'bg-primary/5');
            },

            handleDragLeave() {
                this.elements.dropArea.classList.remove('border-primary', 'bg-primary/5');
            },

            handleDrop(e) {
                e.preventDefault();
                this.elements.dropArea.classList.remove('border-primary', 'bg-primary/5');
                
                if (e.dataTransfer.files.length > 0) {
                    this.handleFile(e.dataTransfer.files[0]);
                }
            },

            // 处理文件
            handleFile(file) {
                // 检查文件类型
                if (file.type !== 'text/plain' && !file.name.endsWith('.txt')) {
                    this.showNotification('请上传TXT格式的文本文件', 'error');
                    return;
                }

                // 显示文件信息
                this.elements.fileName.textContent = file.name;
                this.elements.fileInfo.classList.remove('hidden');
                this.elements.processBtn.disabled = false;
                
                // 添加文件选择动画
                this.elements.fileInfo.classList.add('animate-pulse');
                setTimeout(() => {
                    this.elements.fileInfo.classList.remove('animate-pulse');
                }, 500);
            },

            // 移除文件
            removeFile() {
                this.elements.fileInput.value = '';
                this.elements.fileInfo.classList.add('hidden');
                this.elements.processBtn.disabled = true;
                this.elements.resultsSection.style.opacity = '0';
                setTimeout(() => {
                    this.elements.resultsSection.classList.add('hidden');
                }, 300);
            },

            // 处理号码
            async processNumbers() {
                const file = this.elements.fileInput.files[0];
                if (!file) return;

                // 显示加载状态
                this.elements.validLoading.classList.remove('hidden');
                this.elements.processBtn.disabled = true;
                
                try {
                    // 读取文件内容
                    const content = await this.readFileContent(file);
                    
                    // 处理号码
                    this.processNumbersCore(content, file.name);
                    
                    // 显示结果
                    this.displayResults();
                    
                    // 如果GitHub设置有效，自动保存
                    if (this.checkGithubSettings()) {
                        await this.saveToGithub();
                    } else {
                        this.showNotification('号码处理完成，请配置GitHub信息以保存历史记录', 'info');
                    }
                } catch (error) {
                    console.error('处理文件时出错:', error);
                    this.showNotification(`处理文件时出错: ${error.message}`, 'error');
                } finally {
                    // 隐藏加载状态
                    this.elements.validLoading.classList.add('hidden');
                    this.elements.processBtn.disabled = false;
                }
            },

            // 读取文件内容
            readFileContent(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve(e.target.result);
                    reader.onerror = (e) => reject(e);
                    reader.readAsText(file);
                });
            },

            // 处理号码的核心逻辑
            processNumbersCore(content, fileName) {
                // 重置结果
                this.state.processingResults = {
                    validNumbers: [],
                    invalidNumbers: [],
                    totalCount: 0,
                    fileName: fileName
                };

                // 提取所有可能的号码
                const pattern = /(?:\+?\d{1,3}[-.\s]?)?(?:\(?\d{1,4}\)?[-.\s]?)?[\d-.\s()]{5,15}/g;
                const allNumbers = content.match(pattern) || [];
                this.state.processingResults.totalCount = allNumbers.length;

                // 验证和处理号码
                const country = this.elements.countrySelect.value;
                const shouldValidate = this.elements.validateNumbers.checked;
                const shouldFormat = this.elements.formatNumbers.checked;
                const shouldKeepOrder = this.elements.keepOrder.checked;

                const validNumbers = [];
                const invalidNumbers = [];

                allNumbers.forEach(number => {
                    let isValid = true;
                    
                    if (shouldValidate) {
                        isValid = this.isValidPhone(number, country);
                    }

                    if (isValid) {
                        let processedNumber = number;
                        if (shouldFormat) {
                            processedNumber = this.formatPhoneNumber(number, country);
                        }
                        validNumbers.push(processedNumber);
                    } else {
                        invalidNumbers.push(number);
                    }
                });

                // 去重处理
                let uniqueValid = [];
                if (shouldKeepOrder) {
                    const seen = new Set();
                    validNumbers.forEach(num => {
                        if (!seen.has(num)) {
                            seen.add(num);
                            uniqueValid.push(num);
                        }
                    });
                } else {
                    uniqueValid = [...new Set(validNumbers)];
                }

                // 去重无效号码
                const uniqueInvalid = [...new Set(invalidNumbers)];

                // 保存结果
                this.state.processingResults.validNumbers = uniqueValid;
                this.state.processingResults.invalidNumbers = uniqueInvalid;
                this.state.processingResults.fileName = fileName;
            },

            // 验证电话号码
            isValidPhone(number, country) {
                const digits = number.replace(/\D/g, '');
                
                if (country === 'us' || country === 'all') {
                    // 美国号码：10位或11位(带国家代码1)
                    if (digits.length === 10) return true;
                    if (digits.length === 11 && digits[0] === '1') return true;
                }
                
                if (country === 'cn' || country === 'all') {
                    // 中国号码：11位
                    if (digits.length === 11) return true;
                }
                
                if (country === 'uk' || country === 'all') {
                    // 英国号码：通常10-11位，可能带国家代码44
                    if (digits.length >= 10 && digits.length <= 11) return true;
                    if ((digits.length === 12 || digits.length === 13) && digits.startsWith('44')) return true;
                }
                
                if (country === 'ca' || country === 'all') {
                    // 加拿大号码：同美国格式
                    if (digits.length === 10) return true;
                    if (digits.length === 11 && digits[0] === '1') return true;
                }
                
                if (country === 'au' || country === 'all') {
                    // 澳大利亚号码：10位，可能带国家代码61
                    if (digits.length === 10) return true;
                    if (digits.length === 11 && digits[0] === '61') return true;
                }
                
                // 如果选择"全部"且未匹配上述任何国家规则，简单判断
                if (country === 'all' && digits.length >= 7) return true;
                
                return false;
            },

            // 格式化电话号码
            formatPhoneNumber(number, country) {
                const digits = number.replace(/\D/g, '');
                
                if (country === 'us' || country === 'ca') {
                    let cleaned = digits;
                    if (cleaned.length === 11 && cleaned[0] === '1') {
                        cleaned = cleaned.substring(1);
                    }
                    if (cleaned.length === 10) {
                        return `(${cleaned.substring(0, 3)}) ${cleaned.substring(3, 6)}-${cleaned.substring(6)}`;
                    }
                }
                
                if (country === 'cn') {
                    if (digits.length === 11) {
                        return `${digits.substring(0, 3)} ${digits.substring(3, 7)} ${digits.substring(7)}`;
                    }
                }
                
                if (country === 'uk') {
                    let cleaned = digits;
                    if (cleaned.length === 12 && cleaned.startsWith('44')) {
                        cleaned = '0' + cleaned.substring(2);
                    }
                    if (cleaned.length === 11 && cleaned.startsWith('0')) {
                        return `${cleaned.substring(0, 5)} ${cleaned.substring(5)}`;
                    }
                }
                
                if (country === 'au') {
                    let cleaned = digits;
                    if (cleaned.length === 11 && cleaned.startsWith('61')) {
                        cleaned = '0' + cleaned.substring(2);
                    }
                    if (cleaned.length === 10 && cleaned.startsWith('0')) {
                        return `${cleaned.substring(0, 4)} ${cleaned.substring(4)}`;
                    }
                }
                
                return number;
            },

            // 显示处理结果
            displayResults() {
                const { validNumbers, invalidNumbers, totalCount } = this.state.processingResults;
                
                // 更新计数
                this.elements.validCount.textContent = validNumbers.length;
                this.elements.invalidCount.textContent = invalidNumbers.length;
                this.elements.totalCountEl.textContent = totalCount;
                this.elements.statsValidCount.textContent = validNumbers.length;
                this.elements.statsInvalidCount.textContent = invalidNumbers.length;
                
                // 计算有效号码百分比
                const validPercentage = totalCount > 0 ? (validNumbers.length / totalCount) * 100 : 0;
                // 重置宽度以触发动画
                this.elements.validPercentageBar.style.width = '0%';
                setTimeout(() => {
                    this.elements.validPercentageBar.style.width = `${validPercentage}%`;
                    this.elements.validPercentageText.textContent = `${validPercentage.toFixed(1)}%`;
                }, 50);
                
                // 显示有效号码
                this.elements.validNumbersContainer.innerHTML = validNumbers.length > 0 
                    ? validNumbers.map(num => `<div class="py-1 border-b border-gray-100 last:border-0">${num}</div>`).join('')
                    : '<p class="text-gray-500 italic">没有有效的电话号码</p>';
                
                // 显示无效号码
                this.elements.invalidNumbersContainer.innerHTML = invalidNumbers.length > 0 
                    ? invalidNumbers.map(num => `<div class="py-1 border-b border-gray-100 last:border-0">${num}</div>`).join('')
                    : '<p class="text-gray-500 italic">没有无效的电话号码</p>';
                
                // 更新国家分布统计
                this.updateCountryDistribution(validNumbers);
                
                // 显示结果区域并触发动画
                this.elements.resultsSection.classList.remove('hidden');
                setTimeout(() => {
                    this.elements.resultsSection.style.opacity = '1';
                }, 10);
                
                // 默认显示第一个标签页
                this.showTab('valid-tab');
            },

            // 更新国家分布统计
            updateCountryDistribution(numbers) {
                const countryStats = {
                    'us': 0,    // 美国
                    'cn': 0,    // 中国
                    'uk': 0,    // 英国
                    'ca': 0,    // 加拿大
                    'au': 0,    // 澳大利亚
                    'other': 0  // 其他
                };
                
                numbers.forEach(number => {
                    const digits = number.replace(/\D/g, '');
                    
                    if (digits.length === 10 || (digits.length === 11 && digits[0] === '1')) {
                        // 美国或加拿大
                        if (this.elements.countrySelect.value === 'us') {
                            countryStats['us']++;
                        } else if (this.elements.countrySelect.value === 'ca') {
                            countryStats['ca']++;
                        } else {
                            countryStats['us']++;
                        }
                    } else if (digits.length === 11) {
                        // 中国
                        countryStats['cn']++;
                    } else if (digits.length === 11 && digits.startsWith('0') || 
                              (digits.length === 12 && digits.startsWith('44'))) {
                        // 英国
                        countryStats['uk']++;
                    } else if (digits.length === 10 && digits.startsWith('0') || 
                              (digits.length === 11 && digits.startsWith('61'))) {
                        // 澳大利亚
                        countryStats['au']++;
                    } else {
                        countryStats['other']++;
                    }
                });
                
                // 生成国家分布HTML
                const countryLabels = {
                    'us': '美国',
                    'cn': '中国',
                    'uk': '英国',
                    'ca': '加拿大',
                    'au': '澳大利亚',
                    'other': '其他'
                };
                
                let distributionHtml = '';
                Object.entries(countryStats).forEach(([code, count]) => {
                    if (count > 0) {
                        const percentage = (count / numbers.length) * 100;
                        distributionHtml += `
                            <div>
                                <div class="flex justify-between mb-1">
                                    <span>${countryLabels[code]}</span>
                                    <span>${count} (${percentage.toFixed(1)}%)</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
                                    <div class="bg-primary h-2 rounded-full transition-custom duration-1000 ease-out" style="width: 0%"></div>
                                </div>
                            </div>
                        `;
                    }
                });
                
                this.elements.countryDistribution.innerHTML = distributionHtml || 
                    '<p class="text-gray-500 italic">没有足够的数据生成分布统计</p>';
                
                // 触发动画
                setTimeout(() => {
                    document.querySelectorAll('#country-distribution .bg-primary').forEach((bar, index) => {
                        const [code] = Object.entries(countryStats)[index];
                        if (countryStats[code] > 0) {
                            const percentage = (countryStats[code] / numbers.length) * 100;
                            bar.style.width = `${percentage}%`;
                        }
                    });
                }, 100);
            },

            // 标签页切换
            showTab(tabId) {
                // 移除所有标签页的活跃状态
                this.elements.resultTabs.forEach(tab => {
                    tab.classList.remove('border-primary', 'text-primary');
                    tab.classList.add('border-transparent', 'hover:text-gray-600', 'hover:border-gray-300');
                    tab.setAttribute('aria-selected', 'false');
                });
                
                // 隐藏所有内容
                document.querySelectorAll('#result-tabs-content > div').forEach(content => {
                    content.classList.add('hidden');
                });
                
                // 激活当前标签页
                const activeTab = document.getElementById(tabId);
                activeTab.classList.remove('border-transparent', 'hover:text-gray-600', 'hover:border-gray-300');
                activeTab.classList.add('border-primary', 'text-primary');
                activeTab.setAttribute('aria-selected', 'true');
                
                // 显示当前内容
                const targetContent = document.querySelector(activeTab.getAttribute('data-tabs-target'));
                targetContent.classList.remove('hidden');
            },

            // 保存到GitHub
            async saveToGithub() {
                if (!this.checkGithubSettings()) {
                    this.showNotification('请先配置并测试GitHub连接', 'error');
                    return;
                }
                
                const { validNumbers, fileName } = this.state.processingResults;
                if (validNumbers.length === 0) {
                    this.showNotification('没有有效号码可保存', 'info');
                    return;
                }
                
                try {
                    // 显示加载状态
                    this.elements.validLoading.classList.remove('hidden');
                    
                    const [owner, repo] = this.elements.githubRepoInput.value.split('/');
                    const basePath = this.elements.githubPathInput.value.trim() || 'numbers/history';
                    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
                    const fileExtension = fileName.includes('.') ? fileName.split('.').pop() : 'txt';
                    const fileNameWithoutExt = fileName.split('.').slice(0, -1).join('.') || 'numbers';
                    const filePath = `${basePath}/${fileNameWithoutExt}_${timestamp}.${fileExtension}`;
                    
                    // 准备文件内容
                    const content = validNumbers.join('\n');
                    const encodedContent = btoa(unescape(encodeURIComponent(content)));
                    
                    // 检查文件是否已存在
                    const checkUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`;
                    const checkResponse = await fetch(checkUrl, {
                        headers: {
                            'Authorization': `token ${this.elements.githubTokenInput.value}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    let sha = null;
                    if (checkResponse.ok) {
                        const fileData = await checkResponse.json();
                        sha = fileData.sha;
                    }
                    
                    // 创建或更新文件
                    const url = `https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`;
                    const response = await fetch(url, {
                        method: sha ? 'PUT' : 'POST',
                        headers: {
                            'Authorization': `token ${this.elements.githubTokenInput.value}`,
                            'Content-Type': 'application/json',
                            'Accept': 'application/vnd.github.v3+json'
                        },
                        body: JSON.stringify({
                            message: `保存处理后的电话号码: ${fileNameWithoutExt}`,
                            content: encodedContent,
                            sha: sha // 仅在更新现有文件时需要
                        })
                    });
                    
                    if (!response.ok) {
                        const error = await response.json();
                        throw new Error(error.message || '保存到GitHub失败');
                    }
                    
                    this.showNotification('成功保存到GitHub仓库', 'success');
                    
                    // 重新加载历史记录
                    this.loadHistory();
                } catch (error) {
                    console.error('保存到GitHub失败:', error);
                    this.showNotification(`保存到GitHub失败: ${error.message}`, 'error');
                } finally {
                    // 隐藏加载状态
                    this.elements.validLoading.classList.add('hidden');
                }
            },

            // 导出功能
            exportNumbers(numbers, filename) {
                if (numbers.length === 0) {
                    this.showNotification('没有可导出的号码', 'info');
                    return;
                }
                
                const content = numbers.join('\n');
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                
                // 清理
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 0);
                
                this.showNotification(`已导出 ${numbers.length} 个号码`, 'success');
            },

            // 主题切换
            toggleTheme() {
                const icon = this.elements.themeToggle.querySelector('i');
                this.state.isDarkMode = !this.state.isDarkMode;
                
                if (this.state.isDarkMode) {
                    icon.classList.remove('fa-moon-o');
                    icon.classList.add('fa-sun-o');
                    document.body.classList.add('bg-gray-900', 'text-white');
                    document.body.classList.remove('bg-gray-50', 'text-gray-800');
                    document.querySelector('header').classList.add('bg-gray-800');
                    document.querySelector('header').classList.remove('bg-white');
                } else {
                    icon.classList.remove('fa-sun-o');
                    icon.classList.add('fa-moon-o');
                    document.body.classList.remove('bg-gray-900', 'text-white');
                    document.body.classList.add('bg-gray-50', 'text-gray-800');
                    document.querySelector('header').classList.remove('bg-gray-800');
                    document.querySelector('header').classList.add('bg-white');
                }
            },

            // 通知功能
            showNotification(message, type = 'info') {
                // 设置通知类型
                let iconClass, bgColor;
                
                switch (type) {
                    case 'success':
                        iconClass = 'fa-check-circle text-green-500';
                        bgColor = 'bg-green-50 text-green-800';
                        break;
                    case 'error':
                        iconClass = 'fa-exclamation-circle text-red-500';
                        bgColor = 'bg-red-50 text-red-800';
                        break;
                    case 'info':
                    default:
                        iconClass = 'fa-info-circle text-blue-500';
                        bgColor = 'bg-blue-50 text-blue-800';
                        break;
                }
                
                // 更新通知内容
                this.elements.notification.innerHTML = `
                    <i class="fa ${iconClass} mr-2"></i>
                    <span>${message}</span>
                `;
                this.elements.notification.className = `fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg transform translate-y-0 opacity-100 transition-custom flex items-center z-50 max-w-xs ${bgColor}`;
                
                // 3秒后隐藏通知
                setTimeout(() => {
                    this.elements.notification.className = 'fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-custom flex items-center z-50 max-w-xs';
                }, 3000);
            }
        };
    </script>
</body>
</html>
